# 사용자 가이드 - 날씨 대시보드

이 문서는 Streamlit 기반 날씨 대시보드 앱을 사용하는 방법을 설명합니다. 빠르게 실행해 보고, 주요 기능을 익히는 데 집중했습니다.

## 빠른 시작
- Python 3.9+와 `pip`이 필요합니다.
- 필수 패키지 설치:
  ```
  pip install -r requirements.txt
  ```
- (권장) OpenWeather API 키를 `.streamlit/secrets.toml`에 추가:
  ```
  [api_keys]
  openweather = "YOUR_OPENWEATHER_KEY"
  MAPBOX_API_KEY = "YOUR_MAPBOX_KEY"   # 지도 스타일 커스터마이즈 시 사용
  ```
- 앱 실행:
  ```
  streamlit run streamlit_app.py
  ```

## 기본 사용 흐름
1. **도시 선택**: 사이드바에서 기본 도시를 고르거나 `다른 도시 검색`에 직접 입력합니다.
2. **즐겨찾기**: `현재 도시를 즐겨찾기에 추가` 버튼으로 저장하고, 필요할 때 즐겨찾기 드롭다운에서 전환합니다.
3. **단위 전환**: 섭씨/화씨 라디오 버튼으로 온도 단위를 바꿀 수 있습니다.
4. **데이터 새로고침**: 캐시된 데이터를 초기화하고 다시 불러오려면 `새로고침 (캐시 초기화)` 버튼을 누릅니다.

## 위치 설정
- **IP 기반**: `내 위치 (IP 기반)` 버튼으로 대략적인 도시/좌표를 불러옵니다.
- **브라우저 위치**: `브라우저 위치 가져오기`(권한 필요) 버튼으로 더 정확한 좌표를 사용합니다. `streamlit-geolocation`이 설치돼 있어야 합니다.
- **수동 입력**: `위도`, `경도`에 직접 값을 넣으면 가장 우선적으로 사용됩니다.

## 대시보드 탭 안내
- **날씨 탭**
  - 5일치 3시간 간격 기온/체감온도·습도·강수확률 차트 확인.
  - 예보 표를 펼쳐서 보기 및 `예보 CSV 다운로드`.
  - 현재 원본 데이터를 JSON으로 다운로드.
- **대기질 탭**
  - OpenWeather Air Pollution API가 활성화된 경우 AQI와 주요 오염물질(PM2.5/PM10/NO₂/O₃/SO₂) 지표 표시.
- **지도/경로 탭**
  - 현재 위치 마커 표시.
  - `지도에 경로 표시` 체크 후 `출발지 위도,경도` / `도착지 위도,경도`를 입력하면 선·마커로 경로를 단순 시각화합니다(실제 네비게이션 아님).

## 알림 설정
- 사이드바 슬라이더에서 **강수확률 경고 기준(%)**, **기온 경고 기준**을 조정합니다.
- 조건을 넘으면 화면 상단에 경고 배너가 나타납니다.

## 데이터 소스 및 동작 방식
- OpenWeather API 키가 있을 때: 현재 날씨, 5일 예보, 대기질 데이터를 사용합니다.
- 키가 없거나 실패할 때: Open-Meteo 무료 API를 이용한 대체 모드로 현재/시간별 예보를 제공합니다.
- 캐시는 기본 10분(ttl=600초)이며, 새로고침 버튼으로 바로 초기화할 수 있습니다.

## 문제 해결
- **데이터를 불러올 수 없음**: 도시 철자 확인 → `.streamlit/secrets.toml`에 올바른 키 입력 → 새로고침.
- **위치 감지 실패**: 브라우저 위치 권한 허용 또는 위도/경도를 직접 입력.
- **경로 입력 오류**: `위도,경도` 형식(쉼표로 구분)으로 숫자만 입력했는지 확인.

